<template name="offermodal">
  {{#if quoteToken}}
    {{> newallowance token=quoteToken}}
  {{/if}}
  {{#if baseToken}}
    {{> newallowance token=baseToken}}
  {{/if}}

   <div class="modal fade" id="newOrderModal" tabindex="-1" role="dialog" data-backdrop="false">
    <div class="modal-dialog">
      <div class="modal-content modal-order">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">{{offerType}} OFFER</h4>
        </div>
        <div class="modal-body">
          <table>
            <tbody>
              <tr class="row-data-line">
                <th>ALLOWANCE</th>
                {{#if equals offerType 'buy'}}
                  <td>{{{formatBalance quoteToken.allowance '' '' true}}} <span class="allowance-currency">{{quoteToken._id}}</span></td>
                {{else}}
                  <td>{{{formatBalance baseToken.allowance '' '' true}}} <span class="allowance-currency">{{baseToken._id}}</span></td>
                {{/if}}
              </tr>
              <tr class="row-data-line">
                <th>AVAILABLE</th>
                {{#if equals offerType 'buy'}}
                  <td>{{{formatBalance quoteToken.balance '' '' true}}} <span class="allowance-currency">{{quoteToken._id}}</span></td>
                {{else}}
                  <td>{{{formatBalance baseToken.balance '' '' true}}} <span class="allowance-currency">{{baseToken._id}}</span></td>
                {{/if}}
              </tr>
              <tr class="row-input-line">
                <th>PRICE</th>
                <td><input type="number" class="input" step="any" min="0" {{b "value: offerPrice, input: calcNewOfferTotal"}}><span class="span-offer-currency">{{quoteCurrency}}</span></td>
              </tr>
              <tr class="row-input-line">
                <th>VOLUME</th>
                <td><input type="number" class="input" step="any" min="0" max={{maxNewOfferAmount}} {{b "value: offerAmount, input: calcNewOfferTotal"}}><span class="span-offer-currency">{{baseCurrency}}</span></td>
              </tr>
              <tr class="row-input-line">
                <th>TOTAL</th>
                <td><input type="number" class="input" step="any" min="0" max={{maxNewOfferTotal}} {{b "value: offerTotal, input: calcNewOfferAmount"}}><span class="span-offer-currency">{{quoteCurrency}}</span></td>
              </tr>
            </tbody>
          </table>
          <div class="div-modal-text row">
            <div class="col-xs-1">
              <img src="order-warning.svg" class="order-warning">
            </div>
            <div class="col-xs-11">
              <span class="text-clarifications">
                {{#unless validNewOrderAmount}}
                  Amount is invalid because {{baseCurrency}} has no decimals.
                {{else}}
                  {{#unless hasAllowanceNewOrder offerType}}
                    You are trying to create a {{offerType}} order above your <strong>defined allowance</strong>.
                  {{else}}
                    {{#unless canSubmit}}
                      You are trying to create an invalid {{offerType}} order. Please check the price and the amounts.
                    {{else}}
                      {{#if equals offerType 'buy'}}
                        This action will remove {{{formatBalance (toWei offerTotal) '' '' true}}} {{quoteCurrency}} {{formatPrice (toWei offerTotal) quoteCurrency}} from your token balance and allowance.
                      {{else}}
                        This action will remove {{{formatBalance (toWei offerAmount) '' '' true}}} {{baseCurrency}} {{formatPrice (toWei offerAmount) baseCurrency}} from your token balance and allowance.
                      {{/if}}
                    {{/unless}}
                  {{/unless}}
                {{/unless}}
              </span>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          {{#unless hasAllowanceNewOrder offerType}}
            {{#if equals offerType 'buy'}}
              <button type="button" data-refer="newOrder" data-link={{quoteCurrency}} class="btn btn-allowance-modal btn-default btn-submit-order-allowance btn-placement-right" data-dismiss="modal">Change Allowance</button>
            {{else}}
              <button type="button" data-refer="newOrder" data-link={{baseCurrency}} class="btn btn-allowance-modal btn-default btn-submit-order-allowance btn-placement-right" data-dismiss="modal">Change Allowance</button>
            {{/if}}
          {{else}}
            <button type="button" class="btn btn-default btn-submit-order-{{offerType}} {{offerType}} btn-placement-right" data-dismiss="modal" {{b "enable: canSubmit, click: confirmOffer"}}>{{offerType}} {{baseCurrency}}</button>
          {{/unless}}
          <button type="button" class="btn btn-default btn-placement-left btn-submit-order-cancel" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
</template>
