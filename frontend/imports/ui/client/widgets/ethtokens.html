<template name="ethtokens">
  {{#if isHistory }}
    {{#if equals type 'history'}}
      <h2>HISTORY</h2>
      <div>
        <table class="history">
          <thead>
            <tr>
              <th>DATE</th>
              <th>TYPE</th>
              <th>AMOUNT</th>
            </tr>
          </thead>
          <tbody>
            {{#if history}}
              {{#each history}}
              <tr>
                <td class="timestamp">{{ timestampToString this.timestamp true }}</td>
                <td>{{ this.type }}</td>
                <td class="{{ this.type }}">{{ formatToken this.amount this.token }} {{this.token}}</td>
              </tr>
              {{/each}}
            {{/if}}
          </tbody>
        </table>
      </div>
    {{else}}
      <h2>HISTORY</h2>
      <div>
        <table class="history">
          <thead>
            <tr>
              <th>DATE</th>
              <th>RECIPIENT</th>
              <th>AMOUNT</th>
            </tr>
          </thead>
          <tbody>
            {{#if transferHistory}}
              {{#each transferHistory}}
              <tr>
                <td class="timestamp">{{ timestampToString this.timestamp true }}</td>
                <td><a target="_blank" href="{{ txHref (this.transactionHash) }}">{{ friendlyAddress(this.to) }}</a></td>
                <td class="{{ this.type }} {{ currencyClass this.token }}">{{ formatToken this.amount this.token }} {{this.token}}</td>
              </tr>
              {{/each}}
            {{/if}}
          </tbody>
        </table>
      </div>
    {{/if}}
  {{else}}
  <form id="ethtokens">
    <h2>
      {{title}}
      {{> whatisthis section="eth-tokens"}}
    </h2>
    <div>
      <table>
        <tbody>
          {{#if equals type 'deposit'}}
          <tr class="row-input-line">
            <th>
              ETH
            </th>
            <td>
              {{formatBalance ETHBalance}}
            </td>
          </tr>
          {{else}}
          <tr class="row-input-line">
            <th>
              ETH Tokens
            </th>
            <td class="token">
              {{#let token=(findToken 'ETH')}}
                {{formatBalance token.balance}}
              {{/let}}
            </td>
          </tr>
          {{/if}}
          <tr class="row-input-line">
            <th>
              Amount
            </th>
            <td>
              <input type="number" class="input amount" step="any" min="0" {{b "value: amount, attr: { max: maxAmount }"}}>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th>
            </th>
            <td>
              <button class="btn btn-default" {{b "enable: true, click: deposit"}}>{{title}}</button>
            </td>
          </tr>
          {{#unless equals lastError ''}}
            <tr>
              <td colspan="2">
                {{lastError}}
              </td>
            </tr>
          {{/unless}}
        </tfoot>
      </table>
      {{#if pending}}
        <table>
          <tbody>
            <tr>
              <th colspan="2" style="text-align: center">
                Pending
              </th>
            </tr>
            {{#each pending}}
              <tr>
                <th>
                  {{this.type}}
                </th>
                <td>
                  {{this.amount}}
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{/if}}
    </div>
  </form>
  {{/if}}
</template>
